name: "IntegraciÃ³n Continua - Java CI"

on:
  push:
    branches:
      - main
      - Development
      - 'feature/**'
  pull_request:
    branches:
      - main
      - Development

jobs:
  build:
    name: "Analizar y Compilar el CÃ³digo"
    runs-on: ubuntu-latest

    steps:
      - name: "âœ… Paso 1: Clonar el repositorio"
        uses: actions/checkout@v3

      - name: "âœ… Paso 2: Configurar Java"
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'

      - name: "ğŸ” Paso 3: Analizar estructura del proyecto"
        run: |
          echo "ğŸ“ Verificando la existencia de 'pom.xml'..."
          if [ ! -f "pom.xml" ]; then
            echo "âŒ Error: No se encontrÃ³ el archivo pom.xml en el directorio raÃ­z del proyecto."
            exit 1
          fi
          echo "âœ… Archivo pom.xml encontrado correctamente."

      - name: "ğŸ› ï¸ Paso 4: Compilar con Maven"
        run: |
          echo "ğŸ—ï¸ Iniciando compilaciÃ³n del proyecto..."
          mvn -B clean compile --file pom.xml
          echo "âœ… CompilaciÃ³n exitosa."

      - name: "ğŸ§ª Paso 5: Ejecutar pruebas"
        run: |
          echo "ğŸ§ª Ejecutando pruebas unitarias..."
          mvn test --file pom.xml
          echo "âœ… Pruebas ejecutadas correctamente."

      - name: "ğŸ‰ Paso 6: Ã‰xito total"
        if: ${{ success() }}
        run: echo "âœ… IntegraciÃ³n continua completada con Ã©xito en esta rama. Todo estÃ¡ bien estructurado."

      - name: "ğŸš¨ Error en el flujo"
        if: ${{ failure() }}
        run: echo "âŒ La integraciÃ³n continua ha fallado. Revisa los pasos anteriores para encontrar errores."
